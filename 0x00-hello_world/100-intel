#!/bin/bash
# Script: generate_assembly.sh
# Description: Generates the assembly code (Intel syntax) of a C code and saves it in an output file.

# Check if the $CFILE variable is set
if [[ -z "$CFILE" ]]; then
    echo "Error: C file not specified. Set the CFILE variable to the name of the C file."
    exit 1
fi

# Check if the C file exists
if [[ ! -f "$CFILE" ]]; then
    echo "Error: C file '$CFILE' does not exist."
    exit 1
fi

# Get the base name of the C file without the extension
BASENAME=$(basename -s .c "$CFILE")

# Generate the assembly code using gcc with the -S option
gcc -S -masm=intel "$CFILE" -o "$BASENAME.s"

echo "Assembly code generated successfully. Output file: $BASENAME.s"
